<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.37">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Encuestas Sociales - Randomization and matching</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="..//files/icon-513.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<meta property="og:title" content="Encuestas Sociales - Randomization and matching">
<meta property="og:description" content="The slides for today’s lesson are available online as an HTML file. Use the buttons below to open the slides either as an interactive website or as a static PDF (for printing or storing for later).">
<meta property="og:image" content="https://evalf22.classes.andrewheiss.com/files/social-image-f22.png">
<meta property="og:site-name" content="Encuestas Sociales">
<meta property="og:locale" content="en_US">
<meta property="og:image:height" content="490">
<meta property="og:image:width" content="898">
<meta name="twitter:title" content="Encuestas Sociales - Randomization and matching">
<meta name="twitter:description" content="The slides for today’s lesson are available online as an HTML file. Use the buttons below to open the slides either as an interactive website or as a static PDF (for printing or storing for later).">
<meta name="twitter:image" content="https://evalf22.classes.andrewheiss.com/files/social-image-f22.png">
<meta name="twitter:creator" content="@juankcastillo">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image-height" content="490">
<meta name="twitter:image-width" content="898">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Encuestas Sociales</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../syllabus.html">Programa</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../schedule.html">Planificación</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../content/index.html">Contenidos</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../resource/index.html">Recursos</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.slack.com"><i class="bi bi-slack" role="img" aria-label="Slack">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#readings" id="toc-readings" class="nav-link active" data-scroll-target="#readings">Readings</a>
  <ul class="collapse">
  <li><a href="#rcts-matching-and-inverse-probability-weighting" id="toc-rcts-matching-and-inverse-probability-weighting" class="nav-link" data-scroll-target="#rcts-matching-and-inverse-probability-weighting">RCTs, matching, and inverse probability weighting</a></li>
  </ul></li>
  <li><a href="#slides" id="toc-slides" class="nav-link" data-scroll-target="#slides">Slides</a></li>
  <li><a href="#videos" id="toc-videos" class="nav-link" data-scroll-target="#videos">Videos</a></li>
  <li><a href="#in-class-stuff" id="toc-in-class-stuff" class="nav-link" data-scroll-target="#in-class-stuff">In-class stuff</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header">
<h1 class="title display-7">Randomization and matching</h1>

<div class="date-block bg-content text-white p-2">
  <p class="date">Content for Thursday, February 24, 2022</p>
</div>
</header>

<section id="readings" class="level2">
<h2 class="anchored" data-anchor-id="readings">Readings</h2>
<ul>
<li><i class="fa-solid fa-file-pdf" aria-hidden="true"></i> Andrew Heiss, “Causal Inference,” Chapter 10 in <em>R for Political Data Science: A Practical Guide</em> (2020) (Ignore the exercises!). <a href="../files/10-causal-inference.pdf">Get the PDF here.</a></li>
<li><i class="fa-solid fa-book" aria-hidden="true"></i> Chapter 4 in <em>Impact Evaluation in Practice</em> <span class="citation" data-cites="wb-eval">(<a href="#ref-wb-eval" role="doc-biblioref">Gertler et al. 2016</a>)</span></li>
<li><i class="fa-solid fa-book" aria-hidden="true"></i> Chapters 11 and 13 in <em>The Effect</em> <span class="citation" data-cites="Huntington-Klein:2021">(<a href="#ref-Huntington-Klein:2021" role="doc-biblioref">Huntington-Klein 2021</a>)</span>. <strong>Focus especially on section 13.3 about standard errors.</strong> And skim chapter 11; it’s an overview of regression, which we reviewed in session 2, but it also applies the language of DAGs to regression, so look for that specifically as you read.</li>
<li><i class="fa-solid fa-podcast" aria-hidden="true"></i> Planet Money, <a href="https://www.npr.org/2019/08/30/756028025/episode-937-moving-to-opportunity">“Moving To Opportunity?,”</a> episode 937</li>
<li><i class="fa-solid fa-arrow-up-right-from-square" aria-hidden="true"></i> Aaron Carroll, <a href="https://www.nytimes.com/2018/08/06/upshot/employer-wellness-programs-randomized-trials.html">“Workplace Wellness Programs Don’t Work Well. Why Some Studies Show Otherwise,”</a> <em>The Upshot</em>, August 6, 2018</li>
</ul>
<section id="rcts-matching-and-inverse-probability-weighting" class="level3">
<h3 class="anchored" data-anchor-id="rcts-matching-and-inverse-probability-weighting">RCTs, matching, and inverse probability weighting</h3>
<ul>
<li>The <a href="../example/rcts.qmd">example page on RCTs</a> shows how to use R to analyze and estimate causal effects from RCTs</li>
<li>The <a href="../example/matching-ipw.qmd">example page on matching and inverse probability weighting</a> shows how to use R to close backdoors, make adjustments, and find causal effects from observational data using matching and inverse probability weighting</li>
</ul>
</section>
</section>
<section id="slides" class="level2">
<h2 class="anchored" data-anchor-id="slides">Slides</h2>
<p>The slides for today’s lesson are available online as an HTML file. Use the buttons below to open the slides either as an interactive website or as a static PDF (for printing or storing for later). You can also click in the slides below and navigate through them with your left and right arrow keys.</p>
<p>
<a class="btn btn-danger" target="_blank" href="../slides/07-slides.html"><i class="fa-solid fa-arrow-up-right-from-square"></i> View all slides in new window</a> <a class="btn btn-danger" target="_blank" href="../slides/07-slides.pdf" role="button"><i class="fa-solid fa-file-pdf"></i> Download PDF of all slides</a>
</p>
<ul class="nav nav-tabs" id="slide-tabs" role="tablist">
<li class="nav-item">
<a class="nav-link active" id="introduction-tab" data-toggle="tab" href="#introduction" role="tab" aria-controls="introduction" aria-selected="true">Introduction</a>
</li>
<li class="nav-item">
<a class="nav-link" id="the-magic-of-randomization-tab" data-toggle="tab" href="#the-magic-of-randomization" role="tab" aria-controls="the-magic-of-randomization" aria-selected="false">The magic of randomization</a>
</li>
<li class="nav-item">
<a class="nav-link" id="how-to-analyze-rcts-tab" data-toggle="tab" href="#how-to-analyze-rcts" role="tab" aria-controls="how-to-analyze-rcts" aria-selected="false">How to analyze RCTs</a>
</li>
<li class="nav-item">
<a class="nav-link" id="the-gold-standard-tab" data-toggle="tab" href="#the-gold-standard" role="tab" aria-controls="the-gold-standard" aria-selected="false">The “gold” standard</a>
</li>
<li class="nav-item">
<a class="nav-link" id="adjustment-with-matching-tab" data-toggle="tab" href="#adjustment-with-matching" role="tab" aria-controls="adjustment-with-matching" aria-selected="false">Adjustment with matching</a>
</li>
</ul>
<div id="slide-tabs" class="tab-content">
<div id="introduction" class="tab-pane fade show active" role="tabpanel" aria-labelledby="introduction-tab">
<div class="ratio ratio-16x9">
<iframe src="../slides/07-slides.html#1">
</iframe>
</div>
</div>
<div id="the-magic-of-randomization" class="tab-pane fade" role="tabpanel" aria-labelledby="the-magic-of-randomization-tab">
<div class="ratio ratio-16x9">
<iframe src="../slides/07-slides.html#magic-randomization">
</iframe>
</div>
</div>
<div id="how-to-analyze-rcts" class="tab-pane fade" role="tabpanel" aria-labelledby="how-to-analyze-rcts-tab">
<div class="ratio ratio-16x9">
<iframe src="../slides/07-slides.html#rct-how">
</iframe>
</div>
</div>
<div id="the-gold-standard" class="tab-pane fade" role="tabpanel" aria-labelledby="the-gold-standard-tab">
<div class="ratio ratio-16x9">
<iframe src="../slides/07-slides.html#gold-standard">
</iframe>
</div>
</div>
<div id="adjustment-with-matching" class="tab-pane fade" role="tabpanel" aria-labelledby="adjustment-with-matching-tab">
<div class="ratio ratio-16x9">
<iframe src="../slides/07-slides.html#matching">
</iframe>
</div>
</div>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Fun fact</strong>: If you type <kbd>?</kbd> (or <kbd>shift</kbd> + <kbd>/</kbd>) while going through the slides, you can see a list of special slide-specific commands.</p>
</div>
</div>
</section>
<section id="videos" class="level2">
<h2 class="anchored" data-anchor-id="videos">Videos</h2>
<p>Videos for each section of the lecture are <a href="https://www.youtube.com/playlist?list=PLS6tnpTr39sGJURMOwN9tf9MNDN4t0JMz">available at this YouTube playlist</a>.</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=m4nKVJ-2K3I&amp;list=PLS6tnpTr39sGJURMOwN9tf9MNDN4t0JMz">Introduction</a></li>
<li><a href="https://www.youtube.com/watch?v=-zjSixOybQE&amp;list=PLS6tnpTr39sGJURMOwN9tf9MNDN4t0JMz">The magic of randomization</a></li>
<li><a href="https://www.youtube.com/watch?v=W0NyALrjLA4&amp;list=PLS6tnpTr39sGJURMOwN9tf9MNDN4t0JMz">How to analyze RCTs</a></li>
<li><a href="https://www.youtube.com/watch?v=vHb2TYAze74&amp;list=PLS6tnpTr39sGJURMOwN9tf9MNDN4t0JMz">The “gold” standard</a></li>
<li><a href="https://www.youtube.com/watch?v=jECz-SS-sqc&amp;list=PLS6tnpTr39sGJURMOwN9tf9MNDN4t0JMz">Adjustment with matching</a></li>
</ul>
<p>You can also watch the playlist (and skip around to different sections) here:</p>
<div class="ratio ratio-16x9">
<iframe src="https://www.youtube.com/embed/playlist?list=PLS6tnpTr39sGJURMOwN9tf9MNDN4t0JMz" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="">
</iframe>
</div>
</section>
<section id="in-class-stuff" class="level2">
<h2 class="anchored" data-anchor-id="in-class-stuff">In-class stuff</h2>
<p>Here are all the materials we’ll use in class:</p>
<ul>
<li><a href="../slides/07-class.html"><strong>Session 7 FAQ slides</strong></a> (<a href="../slides/07-class.pdf">PDF</a>)</li>
<li><a href="../projects/rcts-ipw.zip">In-class <code>.zip</code> file</a></li>
<li><a href="https://rstudio.cloud/spaces/205054/project/3646106">RStudio.cloud project</a></li>
<li><a href="../files/rct_vaccine-payments.R">Finished code from in-class example</a> (see also <code>rct_vaccine-payments_finished.Rmd</code> in the <code>.zip</code> file)</li>
</ul>
<p>Other helpful resources:</p>
<ul>
<li><a href="https://www.poverty-action.org/study/impact-mask-distribution-and-promotion-mask-uptake-and-covid-19-bangladesh">“The Impact of Mask Distribution and Promotion on Mask Uptake and COVID-19 in Bangladesh”</a></li>
<li>Macartan Humphreys, <a href="https://macartan.github.io/i/notes/rct_faqs.html">“I saw your RCT and I have some worries! FAQs”</a></li>
<li>Darren Dahly, <a href="https://statsepi.substack.com/p/out-of-balance">“Out of balance: A perspective on covariate adjustment in randomized experiments”</a></li>
<li><a href="../resource/bayes.qmd">Bayesian stats and decison making</a></li>
<li><a href="../example/standard-errors.qmd">Standard errors</a></li>
<li><a href="../example/confounding-sensitivity.qmd">Unobserved confounding and sensitivity analysis</a></li>
</ul>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-wb-eval" class="csl-entry" role="doc-biblioentry">
Gertler, Paul J., Sebastian Martinez, Patrick Premand, Laura B. Rawlings, and Christel M. J. Vermeersch. 2016. <em>Impact Evaluation in Practice</em>. 2nd ed. Inter-American Development Bank; World Bank. <a href="https://openknowledge.worldbank.org/handle/10986/25030">https://openknowledge.worldbank.org/handle/10986/25030</a>.
</div>
<div id="ref-Huntington-Klein:2021" class="csl-entry" role="doc-biblioentry">
Huntington-Klein, Nick. 2021. <em>The Effect: An Introduction to Research Design and Causality</em>. Boca Raton, Florida: <span>Chapman and Hall</span> / CRC. <a href="https://theeffectbook.net/">https://theeffectbook.net/</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Content <i class="fa-brands fa-creative-commons" aria-hidden="true"></i> 2022 by <a href="https://www.jc-castillo.com">Juan Castillo</a> <br> All content licensed under a <i class="fa-brands fa-creative-commons" aria-hidden="true"></i> <i class="fa-brands fa-creative-commons-by" aria-hidden="true"></i> <i class="fa-brands fa-creative-commons-nc" aria-hidden="true"></i> <a href="https://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International license (CC BY-NC 4.0)</a></div>   
    <div class="nav-footer-right">Made with <i class="fa-brands fa-r-project" aria-hidden="true"></i> and <a href="https://quarto.org/">Quarto</a><br> <a href="https://github.com/juancarloscastillo/encuestas-sociales">View the source at <i class="fa-brands fa-github" aria-hidden="true"></i> GitHub</a></div>
  </div>
</footer>



</body></html>